{"version":3,"sources":["webpack:///./src/views/Srdf.vue?8034","webpack:///src/views/Srdf.vue","webpack:///./src/views/Srdf.vue?513a","webpack:///./src/views/Srdf.vue?6d6c","webpack:///./src/views/Srdf.vue?c820","webpack:///./src/views/Srdf.vue?d62e"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","_v","attrs","on","readFile","name","tableHeight","loading","sampleCol","addedCol","sampleData","back","length","annotationSave","annotationConfirm","_e","staticRenderFns","key","required","typeNode","ontologyTerm","searchable","component"],"mappings":"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","file":"js/chunk-abd76b2e.f41f8cce.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"srdf-container\"},[_c('div',{staticClass:\"browse-data-container\"},[_c('Row',{staticStyle:{\"margin-bottom\":\"20px\"}},[_c('div',{staticClass:\"title\"},[_vm._v(\"\\n               Omics Sample to Data Annotation Tool\\n            \")]),_c('div',{staticClass:\"upload\"},[_c('a',{staticClass:\"file\",attrs:{\"href\":\"javascript:;\"}},[_c('i',{staticClass:\"ivu-icon ivu-icon-ios-cloud-upload-outline\"}),_c('span',{staticStyle:{\"margin-left\":\"5px\"}},[_vm._v(\"Upload SRDF File\")]),_c('input',{attrs:{\"type\":\"file\",\"name\":\"\",\"id\":\"file\"},on:{\"change\":_vm.readFile}})])])]),_c('Row',[_c('selfTable',{attrs:{\"name\":_vm.name,\"height\":_vm.tableHeight,\"loading\":_vm.loading,\"columns\":_vm.sampleCol,\"addedCol\":_vm.addedCol,\"data\":_vm.sampleData}}),_c('div',{staticClass:\"button-wrapper\"},[_c('div',{staticClass:\"search-button\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.back}},[_vm._v(\"Back\")])],1),(_vm.sampleCol.length>0 && _vm.sampleData.length>0)?_c('div',{staticClass:\"search-button right\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.annotationSave}},[_vm._v(\"Save\")]),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.annotationConfirm}},[_vm._v(\"Confirm\")])],1):_vm._e()])],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"srdf-container\">\n      <div class=\"browse-data-container\">\n          <Row style=\"margin-bottom: 20px\">\n              <div class=\"title\">\n                 Omics Sample to Data Annotation Tool\n              </div>\n              <div class=\"upload\">\n                <a href=\"javascript:;\" class=\"file\">\n                    <i class=\"ivu-icon ivu-icon-ios-cloud-upload-outline\"></i><span style=\"margin-left: 5px;\">Upload SRDF File</span>\n                    <input type=\"file\" name=\"\" id=\"file\" @change=\"readFile\">\n                </a>\n              </div>\n          </Row>\n          <!-- <Row>\n              <Card>\n                <p slot=\"title\">Omics SDRF Reader</p>\n                <div class=\"table-container\">\n                    <Table stripe border ref=\"selection\" :height='tableHeight'  :loading=\"fileListLoading\" :columns=\"fileListCol\" :data=\"fileList\" ></Table>\n                </div>\n              </Card>\n          </Row>  -->\n          <Row>\n                <selfTable :name=\"name\" :height='tableHeight' :loading=\"loading\" :columns=\"sampleCol\" :addedCol=\"addedCol\" :data=\"sampleData\"></selfTable>\n                <div class=\"button-wrapper\">\n                <div class=\"search-button\">\n                    <Button type=\"primary\" @click=\"back\">Back</Button>\n                </div>\n                <div v-if=\"sampleCol.length>0 && sampleData.length>0\" class=\"search-button right\">\n                    <Button type=\"primary\" @click=\"annotationSave\">Save</Button>\n                    <Button type=\"primary\" @click=\"annotationConfirm\">Confirm</Button>\n                </div>\n            </div>\n          </Row>\n      </div>\n  </div>\n</template>\n<script>\n  var fs = require(\"fs\");\n  import selfTable from '@/components/table.vue'\n  export default {\n    name: 'srdf',\n    data(){\n      return {\n           name:'Omics SDRF Reader',\n           loading:false,\n           sampleCol:[],\n           sampleData:[],\n           keyList:[],\n           addedCol:[],\n           screenHeight: document.documentElement.clientHeight,\n           getTableDataAPI:this.$store.state.baseApiURL + '/properties/getPropertiesFromText',\n           getAddedColAPI:this.$store.state.baseApiURL + '/properties/getProperties',\n      }\n    },\n    beforeRouteUpdate:function (to, from, next) {\n\n    },\n    components: {\n      selfTable\n    },\n    methods:{\n      readFile(event){\n        var files = event.target.files || event.dataTransfer.files;\n        if (!files.length)\n          return;\n\n        let reader = new FileReader();\n        reader.readAsText(files[0],'UTF-8');\n        this.loading=true\n        console.log('重置数据')\n        // this.$set\n        this.sampleCol=[]\n        this.sampleData=[]\n        this.keyList=[]\n        this.addedCol=[]\n        reader.onload =  async (e)=> {\n            let arr = e.currentTarget.result.split('\\n');\n\n            // this.sampleData = []\n            for(let i in arr){\n                if(i == 0){ //for first row which is the col in the table\n                  let header = arr[i].split('\\t');\n                  let properties = ''\n                  for(let j in header){\n                      // if(header[j].match(/\\[/))\n                        properties+=(header[j]+', ')\n                  }\n                  let sdrf_properties = properties.slice(0,properties.length-2)\n                  let query = {\n                      sdrf_properties:sdrf_properties,\n                      // sdrf_properties:'Characteristics[organism], Characteristics[organism part], Characteristics[age], Characteristics[developmental stage], Characteristics[sex], Characteristics[disease], Characteristics[individual], comment[fraction identifier], comment[file uri], comment[instrument], comment[label], comment[cleavage agent details], comment[modification parameters], comment[modification parameters], comment[precursor mass tolerance], comment[fragment mass tolerance], comment[data file]',\n                    }\n                  let results = await this.$http.get(this.getTableDataAPI,{params: query})\n                  // this.sampleCol = []\n                  this.sampleCol.push({\n                      name: '#',\n                      key: 'index',\n                      // align: 'center',\n                      required: true,\n                  })\n                  //console.log('results',results)\n                  for(let i in results.body){\n                    let item = {\n                      name:results.body[i].freeTextColumn,\n                      key:results.body[i].freeTextColumn.replace(/\\s+/g,\"\") + Math.floor(100000 + Math.random() * 900000),\n                      required:false,\n                      typeNode:results.body[i].templateColumn.typeNode ? results.body[i].templateColumn.typeNode : '',\n                      ontologyTerm:results.body[i].templateColumn.ontologyTerm ? results.body[i].templateColumn.ontologyTerm : null,\n                      searchable:results.body[i].templateColumn.searchable\n                    }\n                    this.keyList.push(item)\n                    this.sampleCol.push(item)\n                  }\n                }\n                else{ //for the table data\n                  let body = arr[i].split('\\t');\n                  let item = {}\n                  for(let j in body){\n                      item.index=parseInt(i)\n                      item[this.keyList[j].key]={\n                        value:body[j],\n                        checked:true,\n                        active:false,\n                        required:this.keyList[j].required\n                      }\n                      //console.log('item',item)\n                  }\n                  this.sampleData.push(item)\n                }  \n\n            }\n            console.log('重新赋值sampleDaTA')\n            let tempAddedCol = await this.$http.get(this.getAddedColAPI)\n            for(let i in tempAddedCol.body){\n                tempAddedCol.body[i].key = tempAddedCol.body[i].name.replace(/\\s+/g,\"\") + Math.floor(100000 + Math.random() * 900000),\n                tempAddedCol.body[i].required = false\n            }\n            this.addedCol = tempAddedCol.body\n            // console.log('addedCol',this.addedCol)\n            this.loading=false\n\n            //reset value for loading the same file\n            event.target.value = ''\n            //console.log(this.sampleCol,this.sampleData)\n            //this.$forceUpdate()\n        };\n      },\n      setClassName(name){\n        if(name.match('sourcename') || name.match('characteristics'))\n          return 'blue'\n        else if(name.match('assayname') || name.match('comment'))\n          return 'green'\n        else\n          return 'red'\n      },\n      back(){\n        let projectAccession = localStorage.getItem(\"projectAccession\")\n        if(projectAccession){\n            this.$Modal.confirm({\n                title: 'Uncompleted Annotaion',\n                content: '<p>Do you want to delete the uncompleted annotation?</p>',\n                onOk: () => {\n                    localStorage.clear();\n                    this.$router.push({name:'index'});\n                },\n                onCancel: () => {\n                   \n                }\n            });\n        }\n        else\n          this.$router.push({name:'index'});\n      },\n      annotationConfirm(){\n          this.$Modal.confirm({\n              title: 'Finish Annotation',\n              content: '<p>Do you want to submit this annotation?</p>',\n              onOk: () => {\n                  this.$bus.$emit('annotation-confirm');\n              },\n              onCancel: () => {\n                  \n              }\n          });\n      },\n      annotationSave(){\n          this.$bus.$emit('annotation-save');\n      },\n      getTableData(){\n          console.log('getTableData sampleCol',this.sampleCol)\n          let query = {\n            sdrf_properties:'characteristics[organism], characteristics[organism part]',\n\n          }\n          this.$http\n              .get(this.getTableDataAPI,{params: query})\n              .then(function(res){\n                 console.log(res.body)\n                \n                  // if(res.body._embedded && res.body._embedded.files){\n                   \n                  // }\n                  // else{\n                  //     this.$Message.error({content:'No Files', duration:1});\n                  // }\n              },function(err){\n                  this.fileListLoading = false;\n              });\n      },\n    },\n    watch: {\n\n    },\n    computed:{\n      tableHeight:function(){\n        let minHeight = 300\n        return this.screenHeight - 90*2 - 138 - 20 - 55 - 16*2 > minHeight ? this.screenHeight - 90*2 - 138 - 20 - 55 - 16*2 : minHeight\n      }\n    },\n    mounted: function(){\n        window.onresize = () => {\n          this.screenHeight = document.documentElement.clientHeight\n        }\n    },\n    created(){\n\n    },\n    beforeDestroy(){\n\n    },\n\n  }\n</script>\n\n<style scoped>\n  .browse-data-container{\n    width: 80%;\n    margin:0 auto;\n    padding: 90px 0;\n  }\n  .title{\n    font-size: 35px;\n    color: #454548;\n    margin-bottom: 50px;\n  }\n  .file {\n      position: relative;\n      display: inline-block;\n      background: white;\n      border: 1px solid #2d8cf0;\n      border-radius: 4px;\n      padding: 4px 12px;\n      overflow: hidden;\n      color: #2d8cf0;\n      text-decoration: none;\n      text-indent: 0;\n      line-height: 20px;\n  }\n  .file input {\n      position: absolute;\n      font-size: 100px;\n      right: 0;\n      top: 0;\n      opacity: 0;\n  }\n  .file:hover {\n      background: #2d8cf0;\n      border-color: #2d8cf0;\n      color: white;\n      text-decoration: none;\n  }\n  .button-wrapper{\n    margin-top: 20px;\n    display: flex;\n    justify-content: space-between;\n  }\n  .search-button.right{\n    display: flex;\n    width: 180px;\n    justify-content: space-between;\n  }\n  .search-button button{\n    width: 85px;\n  }\n</style>\n<style >\n.table-container .ivu-table-header table{\n  width: 100% !important;\n}\n.table-container .ivu-table-body table{\n  width: 100% !important;\n}\nth.blue{\n    background-color: #84bafd !important;\n    color: white !important;\n}\nth.green{\n    background-color: #96d810 !important;\n    color: white !important;\n}\nth.red{\n    background-color: #ea7e7c !important;\n    color: white !important;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Srdf.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Srdf.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Srdf.vue?vue&type=template&id=105e36cf&scoped=true&\"\nimport script from \"./Srdf.vue?vue&type=script&lang=js&\"\nexport * from \"./Srdf.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Srdf.vue?vue&type=style&index=0&id=105e36cf&scoped=true&lang=css&\"\nimport style1 from \"./Srdf.vue?vue&type=style&index=1&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"105e36cf\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Srdf.vue?vue&type=style&index=0&id=105e36cf&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Srdf.vue?vue&type=style&index=0&id=105e36cf&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Srdf.vue?vue&type=style&index=1&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Srdf.vue?vue&type=style&index=1&lang=css&\""],"sourceRoot":""}